<html><head>
        
        <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

        
            <link type="text/css" rel="stylesheet" href="/static/css/change.css">

<style type="text/css">
    iframe {
        display: none;
        visibility: hidden;
        z-index: -9999;
    }
</style>
<script type="text/javascript" src="/static/js/w3school/jquery.js"></script>


<script type="text/javascript">



    var id ="";
    var password="";
    var name="";
    var phone="";
    $(document).ready(function(){

        target_url="/api/agent/?phone="+document.getElementById("index").textContent

       $.ajax({
            url: target_url,//后台提供的接口
            type: "get",   //请求方式是post
            success: function (data) {   //成功时返回的data值，注意这个data是后台返回的值，上面的data是你要传给后台的值

                id = data[0]["id"]
                password = data[0]["password"]
                name = data[0]["name"]
                phone = data[0]["phone"]
            }
        });

}        )
    function change_password() {
        target_url="/api/agent/?phone="+document.getElementById("index").value
         $.ajax({
            url: target_url,//后台提供的接口
            type: "get",   //请求方式是post
            success: function (data) {   //成功时返回的data值，注意这个data是后台返回的值，上面的data是你要传给后台的值

                id = data[0]["id"]
                password = data[0]["password"]
                name = data[0]["name"]
                phone = data[0]["phone"]
            }
        });
        if(password == document.getElementById("oldPassword").value){
            if(document.getElementById("newPassword").value != ""){
                if(document.getElementById("newPassword").value == document.getElementById("newPassword2").value ){
                $.ajax({
            url: "/api/agent/"+id+"/",//后台提供的接口
            type: "put",   //请求方式是post
            dataType:"json",
            data :{
                "password":document.getElementById("newPassword").value,
                "name": name,
                "phone": phone,
                 '_method':"PUT"
             },
            success: function (data) {   //成功时返回的data值，注意这个data是后台返回的值，上面的data是你要传给后台的值
                window.location.href="/user/login/"
            },
error:function(msg){
                alert(msg)
           }
        });

          }
          else {
              document.getElementById("chang_button").textContent="两次密码不一致，重试";
              document.getElementById("chang_button").value="两次密码不一致，重试";
          }
            }

        }
        else {
            document.getElementById("chang_button").textContent="旧密码错误，重试";
            document.getElementById("chang_button").value="旧密码错误，重试";
        }

    }


</script>


                
        <script async="" ></script><script>
        var dpr;
        var rem;
        var scale;
        var docEl = document.documentElement;
        var fontEl = document.createElement('style');
        var metaEl = document.querySelector('meta[name="viewport"]');
        var width = docEl.clientWidth;
        if (width > 420) {
            width = 420;
        }
        dpr = window.devicePixelRatio || 1;
        var isAndroid = window.navigator.appVersion.match(/android/gi);
        var isIframe = (window.top != window.self);
        if (isAndroid || isIframe) {
            dpr = 1;
        }
        rem = width * dpr / 10;
        scale = 1 / dpr;
        metaEl.setAttribute('content', 'width=' + dpr * width + ',initial-scale=' + scale + ',maximum-scale=' + scale + ', minimum-scale=' + scale + ',user-scalable=no, viewport-fit=cover');

        docEl.setAttribute('data-dpr', dpr);

        docEl.firstElementChild.appendChild(fontEl);
        fontEl.innerHTML = 'html{font-size:' + rem + 'px!important;}';

        window.rem2px = function (v) {
            v = parseFloat(v);
            return v * rem;
        };
        window.px2rem = function (v) {
            v = parseFloat(v);
            return v / rem;
        };

        window.dpr = dpr;
        </script><style>html{font-size:112.50000447034836px!important;}</style>
   </head>
    <body>
        <div id="pageWrapper">

            
                        
            <header class="pass-header ">

                <span class="pass-header-title">
              修改密码
            </span>
    </header>

            
            
            
            <div class="mod-content">
                



        <p class="error_area" id="error"></p>

                <p class="form-item form-input-wrapper form-item-username form-input-mobile">
            <input type="text" name="username" class="text-input" maxlength="60" placeholder="手机号" value="" id="index">
            <span class="input-clearValue" style="display: none;"></span>
            <span id="login-userlist" class="pass-input-aide pass-input-userlist"></span>
        </p>
        <p class="form-item form-input-wrapper form-item-password form-input-mobile">
            <input type="password" name="password" class="text-input" id="oldPassword" placeholder="旧密码" value="">
            
        </p>
        <p class="form-item form-input-wrapper form-item-password form-input-mobile">
            <input type="password" name="password" class="text-input" id="newPassword" placeholder="新密码" value="">
            
        </p>
        <p class="form-item form-input-wrapper form-item-password form-input-mobile">
            <input type="password" name="password" class="text-input" id="newPassword2" placeholder="确定新密码" value="">
            
        </p>

                <div class="form-btn" onclick="change_password()">
                    <p class="form-item form-item-btn">
                        <input type="submit" value="登录" id="chang_button" class="pass-button-full">
                   </p>

        </div>
                    </div>



        <!--SCRIPT_PLACEHOLDER-->    

</body></html>